
<!-- TOC -->

- [确定报毒位置(2天，优先级高)](#确定报毒位置2天优先级高)
    - [文件(0.5天)](#文件05天)
    - [函数(1天)](#函数1天)
- [代码修改(时间暂时不定，优先级中)](#代码修改时间暂时不定优先级中)
    - [要求](#要求)
    - [实现](#实现)
- [A 收集信息(1天，优先级高)](#a-收集信息1天优先级高)
- [B 用户其他信息采集(1天，优先级高)](#b-用户其他信息采集1天优先级高)
- [服务端获取屏蔽怀疑释放条件对接(优先级高)](#服务端获取屏蔽怀疑释放条件对接优先级高)

<!-- /TOC -->



# 确定报毒位置(2天，优先级高)
(确定具体如何实现)
(开发1.5天+测试0.5天，对.bat命令不熟可能会延长开发周期)
## 文件(0.5天)
1. 反编译要检测的apk,作为输入
2. 检索smali文件夹中出去MainActivity和App文件的个数为m
3. 拷贝m次输入文件，每次删除m个文件中的一个
4. 对m个拷贝的文件夹编译成apk文件
5. 手动上传生成的apk文件到virustotal,查看检测结果

## 函数(1天)
1. 将上一步中的报毒文件A作为输入
2. 检索smali文件中函数个数n
3. 确定没一个函数在smali文件中的开始位置Start~i~和结束位置End~i~
4. 拷贝n份反编译后apk文件，每次删除A文件中找到的Start~i~和End~i~之间的文件
5. 编译删除Start~i~和End~i~之间内容的文件夹，编译生成apk
6. 手动上传生成的apk文件到virustotal,查看检测结果

# 代码修改(时间暂时不定，优先级中)
(确定思路，实现)数量随机
准备不同代码版本时间不太好确定
开发时间
## 要求
1. 类的数量可以随机
2. 类的结构可以调整(函数个数)

以函数名f为文件夹，里面含有多(n)个具体实现，以及其他函数的调用标识##函数名##，参数如何使用
## 实现
函数个数调整
代码段中调用别的代码段时，使用特殊标识，在确定类之后替换
**能不能实现函数的合并**

每个方法文件中记录其使用的需要import的类，字符串，调用的方法及其对应的类名

1. 拆分不同功能代码组成不同的函数(每个函数有多种写法备用)
2. 首先随机确定产生类的个数(设置最大和最小值)m个
3. 随机产生每个类函数个数,并且满足f~1~+...+f~m~=m
4. 每个包写入import内容(不精确匹配0.5天)
5. 随机分配每个函数f~n~到对应的类中，函数名，调用的时候，函数调用的时候需要用到类
6. 根据类和函数的个数不同需要修改SdkToolConfig.xml文件内容，修改的内容有：EditSdkCodeb标签的内容：方法、使用到的类、使用的字符串
7. SdkToolConfig文件修改方法：SdkToolConfig文件

类名为：className+i
函数名为：功能+j

```
class Function {
    //method，class，String常量都要被随机，要在SdkToolConfig文件中记录
    List<String> methodList;    //使用到的方法
    List<String> classList;     //使用到的类
    List<String> strList;       //使用到的字符串
    String codeData;            //函数体,包含需要替换的部分
}

class SdkToolConfig {
    //一个Setup，多个EditSdkCode两个部分需要修改
    //Setup含有多个内容
    //EditSdkCode可以使用HashMap
    List<Function> methodList;  //需要配置的方法
    String fileContentData;     //SdkToolConfig文件内容
}
```

# A 收集信息(1天，优先级高)
动态屏蔽条件获取，用户因为什么原因被屏蔽，被怀疑(陈昭村)
增加：
1、被什么屏蔽以及当前各个信息
2、被什么怀疑以及当前各个信息
3、为什么被释放以及当前各个信息
4、正常运行时各个信息(0.5天加自测)
# B 用户其他信息采集(1天，优先级高)
(陈昭村)
增加：
基站信息和gps信息对比是否大致在同一区域(0.5天)
有无距离传感器(可以作为屏蔽条件)
电池温度(能不能拿到)
iccid(固话在sim卡中)(三个0.5天)
# 服务端获取屏蔽怀疑释放条件对接(优先级高)
(提测)(陈昭村)
等提测

其中A.B包放出去采集时间暂定一天

